insert into PARTICIPATED values('KA20 2015478', 'KA22 S6325', 7, 5000);

i) SELECT COUNT(DISTINCT DRIVERID)
    FROM PARTICIPATED
    WHERE REPORT_NUMBER IN(SELECT REPORT_NUMBER FROM ACCIDENT WHERE EXTRACT(YEAR FROM ACC_DATE)=2019);


ii)SELECT COUNT(PARTICIPATED.REGNO) FROM PARTICIPATED, CAR WHERE PARTICIPATED.REGNO=CAR.REGNO AND CAR.MODEL='Hyundai Creta';

iii)SELECT NAME OWNER_NAME, COUNT(REPORT_NUMBER) NO_OF_ACCIDENT, SUM(DAMAGE_AMOUNT) TOTAL_DAMAGE FROM PARTICIPATED, PERSON WHERE PERSON.DRIVERID = PARTICIPATED.DRIVERID GROUP BY name ORDER BY SUM(DAMAGE_AMOUNT) DESC;

(LINE 10 OR LINES 13-27)

SELECT 
    NAME AS OWNER_NAME, 
    COUNT(REPORT_NUMBER) AS NUMBER_OF_ACCIDENTS, 
    SUM(DAMAGE_AMOUNT) AS TOTAL_DAMAGE 
FROM 
    PARTICIPATED 
    INNER JOIN PERSON ON PERSON.DRIVERID = PARTICIPATED.DRIVERID 
GROUP BY 
    NAME 
HAVING 
    COUNT(REPORT_NUMBER) > 0 
ORDER BY 
    TOTAL_DAMAGE DESC;


iv) 
SELECT driverid,extract(YEAR FROM acc_date),count(driverid)
FROM participated
NATURAL JOIN accident
GROUP BY extract(YEAR FROM acc_date), driverid
HAVING COUNT(driverid) > 0
order by extract(YEAR FROM acc_date) desc

v) SELECT PERSON.NAME FROM PERSON MINUS (SELECT DISTINCT PERSON.NAME FROM PERSON,PARTICIPATED WHERE PERSON.DRIVERID = PARTICIPATED.DRIVERID);
